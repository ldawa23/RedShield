from dataclasses import dataclass
from core.constants import SEVERITY_LEVELS

@dataclass
class Vulnerability:
    id: int             # simple int for now(fake), real DB id later
    target: str         # IP or hostname
    vuln_type: str
    service: str        # "Exposed_Database_Port"
    port: int           # "MongoDB, SSH
    severity: str  # "Critical, High, Medium, Low
    status: str      # "Discovered, verified, fixed, ignored

    def priority_score(self) -> int:
        """COnvert severity string to numeric score."""
        return SEVERITY_LEVELS.get(self.severity,0)
